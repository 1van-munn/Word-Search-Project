<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Word Scramble - Game</title>
        <link rel="stylesheet" href="style.css">
        
        <!-- PyScript CSS -->
        <link rel="stylesheet" href="https://pyscript.net/releases/2025.7.3/core.css">

        <!-- This script tag bootstraps PyScript -->
        <script type="module" src="https://pyscript.net/releases/2025.7.3/core.js"></script>
    </head>
    <body>
        <div>
            <header>
               <a class="link" href="index.html">Home</a>
               <div class="game-stats">
                    <p>Score: <span id="score"></span></p>
                    <p> Round: <span id="round"></span></p>
               </div>
            </header>
        
        <!--All print statement's will go to this div-->
        <div id="out"></div>
        
        <!--creates submit button and input box-->
        <div class="io">
            <input id="answer" placeholder="type your answer here">
            <button id="submit-btn">Submit</button>
        </div>
        <py-script output="out">
        from js import document
        import asyncio

        # minimal in-page input
        async def ask(prompt=""):
            print(prompt, end="") # goes to div with an id="out" because of output="out"
            box = document.getElementById("answer")
            box.value = ""
            box.focus()

            loop = asyncio.get_event_loop()
            fut = loop.create_future()

            def on_click(_):
                if not fut.done():
                    fut.set_result(box.value)

            document.getElementById("submit-btn").addEventListener("click", on_click, { "once": True })
            val = await fut
            print(val)     # echo the input to the page (optional)
            return val

        #async def main():
            #python code begins
            import random, time 
            wordLists = [ 
                ["rip", "sun", "zip", "box", "hat", "bat", "pen", "man", "key", "mud"], 
                ["mint", "snow", "milk", "bark", "gold", "nest", "drip", "clay", "frog", "tent"], 
                ["plant", "grape", "stone", "bread", "chair", "flame", "train", "shelf", "cloud", "crane"], 
            ] 
            
            bonusList = [ 
                ["planet", "silver", "singer", "forest", "branch", "danger", "friend", "stream", "artist", "circle"], 
                ["husband", "morning", "blanket", "cabinet", "teacher", "picture", "fortune", "airport", 
            "kingdom", "journey"], 
            ]
            
            def scramble(listNumber, index, scrambleList): 
                word = scrambleList[listNumber].pop(index) 
                wordList = list(word) 
                random.shuffle(wordList) 
                scrambledWord = ''.join(wordList) 
                while (scrambledWord == word): 
                    random.shuffle(wordList) 
                    scrambledWord = ''.join(wordList) 
                if(len(word) == 3): 
                    print("This word is nice and easy. You got this!") 
                elif(len(word) <= 5): 
                    print("This word is slightly difficult, but you've got it!") 
                else: 
                    print("Now this is hard. Good luck! (you're going to need it)") 
                return(scrambledWord, word) 
            
            def time_taken(score, timeTaken): 
                if (timeTaken < 3): 
                    print("Quick answer! Bonus point awarded.") 
                    return (score + 2) 
                elif (timeTaken < 7): 
                    print("Correct in good time!") 
                    return (score + 1) 
                else: 
                    print("Correct, but try to be quicker.") 



                    return (score + .5) 
                
            listNumber = 0 
            score = 0 
            attempts = 0 
            wordsMain = 0 
            
            print("Welcome to the word scramble guessing game! You will have five attempts to "
                "correctly unscramble one three letter word, one four letter word, and one "
                "five letter word. If you complete this task, you will have the option to " 
                "participate in a bonus game to improve your score. Good luck!") 
            print("") 
            while(True): 
                user_input = (await ask("Type 'ready' to continue: ")).strip().lower() 
                print("") 
                if user_input == 'ready': 
                    break 
            
            while (attempts < 5): 
                attempts = attempts + 1 
                wordsMain = wordsMain + 1 
                index = random.randint(0, len(wordLists[listNumber]) - 1) 
                scrambled_word, correctGuess = scramble(listNumber, index, wordLists) 
                print ("Unscramble the word:", scrambled_word) 
                start_time = time.time() 
                guess = await ask("Your guess: ") 
                end_time = time.time() 
                timeTaken = end_time - start_time 
                if (guess.lower() == correctGuess.lower()): 
                    score = time_taken(score, timeTaken) 
                    listNumber = listNumber + 1 
                else: 
                    print ("Incorrect, the correct word is:", correctGuess) 
                    if (listNumber >= 1): 
                        listNumber = listNumber - 1 
                        
                print ("") 
                if (listNumber == 3): 
                    break 
                
            if (listNumber == 3): 
                print ("Congratulations, you win! Enter 'one' if you would like to play a bonus game. " 
                    "Enter 'two' if you would not like to participate.")     
                bonusGame = (await ask()).strip().lower() 
                print ("") 
                while ((bonusGame != 'one') and (bonusGame != 'two')): 
                    print ("Invalid input. Enter 'one' if you would like to play a bonus game. " 
                        "Enter 'two' if you would not like to participate.") 
                    bonusGame = (await ask()).strip().lower()
                    print("") 
            else: 
                print ("You lose, play again.") 
                bonusGame = 'two' 
            
            if (bonusGame == 'two'): 
                print("Your score was: ", score, " / ", 2 * (wordsMain)) 
            else: 
                listNumber = 0 
                while (True): 
                    index = random.randint(0, len(bonusList[listNumber]) - 1) 
                    scrambled_word, correctGuess = scramble(listNumber, index, bonusList) 
                    print ("Unscramble the word:", scrambled_word) 
                    start_time = time.time() 
                    guess = await ask("Your guess: ") 
                    end_time = time.time() 
                    timeTaken = end_time - start_time 
                    if (guess.lower() == correctGuess.lower()): 
                        score = time_taken(score, timeTaken) 
                        listNumber = listNumber + 1 
                    
                    else: 
                        print ("Incorrect, the correct word is:", correctGuess) 
                        print ("") 
                        break 
                    
                    print ("") 
                    if (listNumber == 2): 
                        break 
                    
                print ("Outstanding! Your score was ", score, " / ", 2 * (wordsMain)) 


            #get a print statement to go to an element with an id of "out" Element("out").write("Hello from Python")
        # start the async flow
        #asyncio.create_task(main())
        </py-script>
    </body>
</html>